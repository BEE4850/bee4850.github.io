{
  "hash": "09304e6c0e29c501413965e1cd2104e4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Hypothesis Testing\"\nsubtitle: \"Lecture 16\"\nauthor: \"Vivek Srikrishnan\"\ncourse: \"BEE 4850\"\ninstitution: \"Cornell University\"\ndate: \"April 10, 2024\"\nformat:\n    revealjs:\n        slide-number: c/t\n        show-slide-number: all\n        center-title-slide: true\n        width: 1280\n        height: 720\n        transition: none\n        toc: true\n        toc-depth: 1\n        toc-title: \"Overview\"\n        history: false\n        link-external-newwindow: true\n        theme: ../sass/slides.scss\n        template-partials:\n            - title-slide.html\n        menu:\n            numbers: true\n        html-math-method: \n            method: mathjax\n            url: \"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js\"\n        include-in-header: mathjax-config.html\n        date-format: long\n        email-obfuscation: javascript\n        chalkboard:\n            theme: whiteboard\n            buttons: true\n        touch: false\n        controls: true\nexecute:\n    freeze: auto\n---\n\n\n\n\n\n# Last Class(es)\n\n## Markov Chain Monte Carlo\n\n- Generate an appropriate Markov chain so that its stationary distribution of the target distribution $\\pi$;\n- Run its dynamics long enough to converge to the stationary distribution;\n- Use the resulting ensemble of states as Monte Carlo samples from $\\pi$ .\n\n## Markov Chain Convergence\n\nGiven a Markov chain $\\{X_t\\}_{t=1, \\ldots, T}$ returned from this procedure, sampling from distribution $\\pi$:\n\n- $\\mathbb{P}(X_t = y) \\to \\pi(y)$ as $t \\to \\infty$\n- This means the chain can be considered a *dependent* sample approximately distributed from $\\pi$.\n- The first values (the *transient portion*) of the chain are highly dependent on the initial value.\n\n## The Metropolis-Hastings Algorithm\n\nGiven $X_t = x_t$:\n\n1. Generate $Y_t \\sim q(y | x_t)$;\n2. Set $X_{t+1} = Y_t$ with probability $\\rho(x_t, Y_t)$, where\n    $$\\rho(x, y) = \\min \\left\\{\\frac{\\pi(y)}{\\pi(x)}\\frac{q(x | y)}{q(y | x)}, 1\\right\\},$$\n    else set $X_{t+1} = x_t$.\n\n## MCMC Convergence\n\n- Must rely on \"accumulation of evidence\" from heuristics for determination about convergence to stationary distribution.\n- Transient portion of chain: Meh. Some people worry about this too much. Discard or run the chain longer.\n- Parallelizing solves few problems, but running multiple chains can be useful for diagnostics.\n\n# Hypothesis Testing\n\n## What Is Hypothesis Testing?\n\n::: {.fragment .fade-in}\n- Is a time series stationary?\n- Does some environmental condition have an effect on water quality/etc?\n- Does a drug or treatment have some effect?\n:::\n\n## Example: Storm Surge Nonstationarity\n\n**Standard Extreme Value Models (GEV/GPD)**: No long-term trend in the data (extremes follow the same distribution)\n\nThis is an example of a **null hypothesis**: no meaningful effect.\n\n## Example: Storm Surge Nonstationarity\n\n**Alternative Hypothesis**: There is a long-term trend in the data.\n\n::: {.fragment .fade-in}\nHow can we draw conclusions about whether apparent trends are \"real\" (alternative hypothesis) or noise (null hypothesis)?\n:::\n\n## Hypothesis Testing Notation\n\n- $\\mathcal{H}_0$: null\n- $\\mathcal{H}$: alternative\n\n## Non-Parametric Statistics for Non-Stationarity\n\n**Mann-Kendall Test**: Assume data is independent, but no specific distributional assumption\n\n$$S = \\sum_{i=1}^{n-1} \\sum_{j={1+1}}^n \\text{sgn}\\left(y_i - y_j\\right).$$\n\n\n## Parametric Statistics for Non-Stationarity\n\nFit a regression \n\n$$\n\\begin{gather*}\ny_i = \\beta t + \\varepsilon_i, \\\\\n\\varepsilon_i \\sim \\mathcal{N}(0, \\sigma^2\\mathbb{I}).\n\\end{gather*}\n$$\n\n\n## Statistical Significance\n\nIs the value of the test statistic consistent with the null hypothesis?\n\nMore formally, could the test statistic have been reasonably observed from a random sample **given the null hypothesis**?\n\n## Statistical Significance\n\n***Note***: Statistical significance does not mean anything about whether the alternative hypothesis is \"true\" or an accurate reflection of the data-generating process.\n\nMore clever null hypothesis setups can get around this, but they aren't the default.\n\n## Non-Parametric Null Hypothesis\n\n$\\mathcal{H}_0: S = 0$ (no average trend).\n\nThe sampling distribution of $S$ consistent with that hypothesis is\n$$S \\sim \\mathcal{N}\\left(0, \\frac{2(2n+5)}{9n(n-1)}\\right).$$\n\n## Parametric Null Hypothesis\n\n$\\mathcal{H}_0$: \\beta = 0\n\nAssuming normally-distributed errors and sampling distributions for the OLS estimate of $\\beta$:\n\n$$\\beta \\sim \\mathcal{N}\\left(\\mathbf{0}, \\sigma^2\\left(X^TX\\right)^{-1}\\right)$$. \n\n## Error Types\n\n<table>\n  <tr>\n    <td></td>\n    <td></td>\n    <td colspan=\"2\">**Null Hypothesis Is**</td>\n  </tr>\n  <tr>\n    <td></td>\n    <td></td>\n    <td>True</td>\n    <td>False </td>\n  </tr>\n  <tr>\n    <td rowspan=\"2\">**Decision About Null Hypothesis**</td>\n    <td>Don't reject</td>\n    <td>True negative (probability $1-\\alpha$)</td>\n    <td>Type II error (false negative, probability $\\beta$)</td>\n  </tr>\n  <tr>\n    <td>Reject</td>\n    <td>Type I Error (false positive, probability $\\alpha$)</td>\n    <td>True positive (probability $1-\\beta$)</td>\n  </tr>\n</table>\n\nThe **significance level** $\\alpha$ is the probability of rejecting the null hypothesis **assuming that it is true** (Type I errror).\n\n\n\n# Upcoming Schedule\n\n## Next Classes\n\n**Next Week**: Model Evaluation/Selection Criteria\n\n## Assessments\n\n- **Homework 4**: Released End of Week, Due 5/3 (Last One!)\n\n# References\n\n## References\n\n",
    "supporting": [
      "lecture10-1_files"
    ],
    "filters": [],
    "includes": {}
  }
}